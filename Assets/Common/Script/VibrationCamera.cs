//================================================================================================================
// VibrationCamera.cs
// 製作者：戸軽隆二
//================================================================================================================
/* 概要
		１．プレイヤー同士の座標を調べ、そこから中間座標を調べる
		２．だんだんと加速しながらそこに近づく
		３．お互いに中間地点に到達したら停止
		４．親子関係にある敵を全て削除
*/
//================================================================================================================
// バージョン
//		1.0 クラス生成                               2017/03/08 戸軽隆二 
//================================================================================================================
using UnityEngine;

public class VibrationCamera : SingletonMonoBehaviour<VibrationCamera> {
	//---------------------------------------------------------------
	// private変数
	Vector3 startPos = new Vector3();
	bool shakeFlg = false;
	bool chageFlg = false;
	float radius = 0;
	//---------------------------------------------------------------
	// public変数
	public float radiusMax = 3;
	public float speed = 3;

	//================================================================================================================
	// 最初に１度だけ実行
	//================================================================================================================
	void Start() {

	}
	//================================================================================================================
	// 常に更新し続ける処理
	//================================================================================================================
	void Update() {
		if (shakeFlg == true) {
			Vector3 pos = transform.position;
			pos.y = startPos.y + Mathf.Sin(Time.time * speed) * radius;
			transform.position = pos;

			if (radius > 0)
				radius -= speed / ((1000 * radiusMax) / 4);
			else
				Initialize();
		}
	}
	//================================================================================================================
	// 初期化の処理
	//================================================================================================================
	void Initialize() {
		shakeFlg = false;
		radius = radiusMax;
		Vector3 pos = transform.position;
		pos.y = startPos.y;
		transform.position = pos;
	}
	//================================================================================================================
	// カメラを振動させる
	//================================================================================================================
	public void Vibration() {
		shakeFlg = true;
		radius = radiusMax;
		startPos = transform.position;
	}
}